<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Модуль ngx_http_uwsgi_module</title><style type="text/css">body { background: white; color: black; font-family: sans-serif; line-height: 1.4em; text-align: center; margin: 0; padding: 0; } #banner { background: black; color: #F2F2F2; line-height: 1.2em; padding: .3em 0; box-shadow: 0 5px 10px black; } #banner a { color: #00B140; } #main { text-align: left; margin: 0 auto; min-width: 32em; max-width: 64em; } #menu { float: right; width: 11em; padding: 0 .5em 1em .5em; border-left: 2px solid #DDD; } #content { margin-right: 13.5em; padding: 0 .2em 0 1.5em; } h1 { display: block; font-size: 3em; text-align: left; height: .7em; margin: 0; margin-bottom: .5em; } h1 img { width: 100%; } h2 { text-align: center; } p { text-align: justify; } table.news p { margin-top: 0; } table.news td { vertical-align: baseline; } table.news .date { text-align: right; padding-right: 0.5em; white-space: nowrap; } table.donors td { vertical-align: baseline; } table.donors li { text-align: left; } div.directive { background: #F2F2F2; line-height: 1em; margin: 1em 0 1em -1em; padding: .7em .7em .7em 1em; border-top: 2px solid #DDD; } div.directive th { padding-left: 0; padding-right: .5em; vertical-align: baseline; text-align: left; font-weight: normal; } div.directive td { vertical-align: baseline; } div.directive pre { padding: 0; margin: 0; } div.directive p { margin: .5em 0 0 .1em; font-size: .8em; } a.notrans { color: gray; text-decoration:none; } span.initial { font-size: 200%; float: left; padding-right: 10pt;} ul, ol { margin: .5em 0 1em 1em; padding: 0 .5em; } ol { list-style-position: inside; } li { text-align: justify; padding: .5em 0 0 1px; } .compact li { padding-top: 0; } dl { margin: .5em 0 1em 0; } dt { margin: .5em 0; } .compact dt { margin-bottom: .2em; } dd { margin-left: 1.5em; padding-left: 1px; text-align: justify; } td.list { background: #F2F2F2; } blockquote { margin: 1em 0 1em 1em; padding: .5em; } li blockquote, dd blockquote { margin: .7em 0; } blockquote.note { border: 1px dotted #999; line-height: 1.2em; text-align: justify; } blockquote.example { line-height: 1em; border-left: 1px solid #BBB; } blockquote.example pre { padding: 0; margin: 0; } sup { font-size: 50%; } .video { position: relative; padding-bottom: 56.25%; overflow: hidden; } .video iframe, .video object, .video embed { position: absolute; top:0; left:0; width:100%; height:100%; }</style><script>
        window.addEventListener("load", function(e) {
            fetch("../../../banner/banner.html")
                .then((response) => response.text())
                .then((resp) => {
                    document.getElementById("banner").innerHTML = resp;
                })
                .catch((error) => {
                    console.warn(error);
                });
        });
    </script></head><body><div id="banner"></div><div id="main"><div id="menu"><h1><a href="/"><img src="/nginx.png" alt="nginx"></a></h1><div><a href="../../../en/docs/http/ngx_http_uwsgi_module.html">english</a><br>русский<br><br><a href="../../../">новости</a> [en]<br><a href="../../../ru/">об nginx</a><br><a href="../../../ru/download.html">скачать</a><br><a href="../../../en/security_advisories.html">безопасность</a> [en]<br><a href="../../../ru/docs/">документация</a><br><a href="../../../ru/docs/faq.html">faq</a><br><a href="../../../en/books.html">книги</a> [en]<br><a href="../../../ru/support.html">поддержка</a><br><br><a href="http://trac.nginx.org/nginx">trac</a><br><a href="http://twitter.com/nginxorg">twitter</a><br><a href="https://www.nginx.com/blog/">blog</a><br><br><a href="https://unit.nginx.org/">unit</a><br><a href="../../../ru/docs/njs/">njs</a><br></div></div><div id="content"><h2>Модуль ngx_http_uwsgi_module</h2><table width="100%"><tr><td align="left"><a href="#example">Пример конфигурации</a><br><a href="#directives">Директивы</a><br>     <a href="#uwsgi_bind">uwsgi_bind</a><br>     <a href="#uwsgi_buffer_size">uwsgi_buffer_size</a><br>     <a href="#uwsgi_buffering">uwsgi_buffering</a><br>     <a href="#uwsgi_buffers">uwsgi_buffers</a><br>     <a href="#uwsgi_busy_buffers_size">uwsgi_busy_buffers_size</a><br>     <a href="#uwsgi_cache">uwsgi_cache</a><br>     <a href="#uwsgi_cache_background_update">uwsgi_cache_background_update</a><br>     <a href="#uwsgi_cache_bypass">uwsgi_cache_bypass</a><br>     <a href="#uwsgi_cache_key">uwsgi_cache_key</a><br>     <a href="#uwsgi_cache_lock">uwsgi_cache_lock</a><br>     <a href="#uwsgi_cache_lock_age">uwsgi_cache_lock_age</a><br>     <a href="#uwsgi_cache_lock_timeout">uwsgi_cache_lock_timeout</a><br>     <a href="#uwsgi_cache_max_range_offset">uwsgi_cache_max_range_offset</a><br>     <a href="#uwsgi_cache_methods">uwsgi_cache_methods</a><br>     <a href="#uwsgi_cache_min_uses">uwsgi_cache_min_uses</a><br>     <a href="#uwsgi_cache_path">uwsgi_cache_path</a><br>     <a href="#uwsgi_cache_purge">uwsgi_cache_purge</a><br>     <a href="#uwsgi_cache_revalidate">uwsgi_cache_revalidate</a><br>     <a href="#uwsgi_cache_use_stale">uwsgi_cache_use_stale</a><br>     <a href="#uwsgi_cache_valid">uwsgi_cache_valid</a><br>     <a href="#uwsgi_connect_timeout">uwsgi_connect_timeout</a><br>     <a href="#uwsgi_force_ranges">uwsgi_force_ranges</a><br>     <a href="#uwsgi_hide_header">uwsgi_hide_header</a><br>     <a href="#uwsgi_ignore_client_abort">uwsgi_ignore_client_abort</a><br>     <a href="#uwsgi_ignore_headers">uwsgi_ignore_headers</a><br>     <a href="#uwsgi_intercept_errors">uwsgi_intercept_errors</a><br>     <a href="#uwsgi_limit_rate">uwsgi_limit_rate</a><br>     <a href="#uwsgi_max_temp_file_size">uwsgi_max_temp_file_size</a><br>     <a href="#uwsgi_modifier1">uwsgi_modifier1</a><br>     <a href="#uwsgi_modifier2">uwsgi_modifier2</a><br>     <a href="#uwsgi_next_upstream">uwsgi_next_upstream</a><br>     <a href="#uwsgi_next_upstream_timeout">uwsgi_next_upstream_timeout</a><br>     <a href="#uwsgi_next_upstream_tries">uwsgi_next_upstream_tries</a><br>     <a href="#uwsgi_no_cache">uwsgi_no_cache</a><br>     <a href="#uwsgi_param">uwsgi_param</a><br>     <a href="#uwsgi_pass">uwsgi_pass</a><br>     <a href="#uwsgi_pass_header">uwsgi_pass_header</a><br>     <a href="#uwsgi_pass_request_body">uwsgi_pass_request_body</a><br>     <a href="#uwsgi_pass_request_headers">uwsgi_pass_request_headers</a><br>     <a href="#uwsgi_read_timeout">uwsgi_read_timeout</a><br>     <a href="#uwsgi_request_buffering">uwsgi_request_buffering</a><br>     <a href="#uwsgi_send_timeout">uwsgi_send_timeout</a><br>     <a href="#uwsgi_socket_keepalive">uwsgi_socket_keepalive</a><br>     <a href="#uwsgi_ssl_certificate">uwsgi_ssl_certificate</a><br>     <a href="#uwsgi_ssl_certificate_key">uwsgi_ssl_certificate_key</a><br>     <a href="#uwsgi_ssl_ciphers">uwsgi_ssl_ciphers</a><br>     <a href="#uwsgi_ssl_conf_command">uwsgi_ssl_conf_command</a><br>     <a href="#uwsgi_ssl_crl">uwsgi_ssl_crl</a><br>     <a href="#uwsgi_ssl_name">uwsgi_ssl_name</a><br>     <a href="#uwsgi_ssl_password_file">uwsgi_ssl_password_file</a><br>     <a href="#uwsgi_ssl_protocols">uwsgi_ssl_protocols</a><br>     <a href="#uwsgi_ssl_server_name">uwsgi_ssl_server_name</a><br>     <a href="#uwsgi_ssl_session_reuse">uwsgi_ssl_session_reuse</a><br>     <a href="#uwsgi_ssl_trusted_certificate">uwsgi_ssl_trusted_certificate</a><br>     <a href="#uwsgi_ssl_verify">uwsgi_ssl_verify</a><br>     <a href="#uwsgi_ssl_verify_depth">uwsgi_ssl_verify_depth</a><br>     <a href="#uwsgi_store">uwsgi_store</a><br>     <a href="#uwsgi_store_access">uwsgi_store_access</a><br>     <a href="#uwsgi_temp_file_write_size">uwsgi_temp_file_write_size</a><br>     <a href="#uwsgi_temp_path">uwsgi_temp_path</a><br></td></tr></table>

<a name="summary"></a><p>
Модуль <code>ngx_http_uwsgi_module</code> позволяет передавать
запросы uwsgi-серверу.
</p>


<a name="example"></a><center><h4>Пример конфигурации</h4></center><p>
</p> <blockquote class="example"><pre>
location / {
    include    uwsgi_params;
    uwsgi_pass localhost:9000;
}
</pre></blockquote><p> 
</p>


<a name="directives"></a><center><h4>Директивы</h4></center><a name="uwsgi_bind"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_bind</strong> 
    <code><i>адрес</i></code>
    [<code>transparent</code>] |
    <code>off</code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            
            —
        
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Задаёт локальный IP-адрес с необязательным портом (1.11.2),
который будет использоваться в исходящих соединениях с uwsgi-сервером.
В значении параметра допустимо использование переменных (1.3.12).
Специальное значение <code>off</code> (1.3.12) отменяет действие
унаследованной с предыдущего уровня конфигурации
директивы <code>uwsgi_bind</code>, позволяя системе
самостоятельно выбирать локальный IP-адрес и порт.
</p><a name="uwsgi_bind_transparent"></a><p>
Параметр <code>transparent</code> (1.11.0) позволяет
задать нелокальный IP-aдрес, который будет использоваться в
исходящих соединениях с uwsgi-сервером,
например, реальный IP-адрес клиента:
</p> <blockquote class="example"><pre>
uwsgi_bind $remote_addr transparent;
</pre></blockquote><p> 
Для работы параметра
обычно требуется
запустить рабочие процессы nginx с привилегиями
<a href="../ngx_core_module.html#user">суперпользователя</a>.
В Linux этого не требуется (1.13.8), так как если
указан параметр <code>transparent</code>, то рабочие процессы
наследуют capability <code>CAP_NET_RAW</code> из главного процесса.
Также необходимо настроить таблицу маршрутизации ядра
для перехвата сетевого трафика с uwsgi-сервера.
</p><a name="uwsgi_buffer_size"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_buffer_size</strong> <code><i>размер</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_buffer_size 4k|8k;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Задаёт <code><i>размер</i></code> буфера, в который будет читаться
первая часть ответа, получаемого от uwsgi-сервера.
По умолчанию размер одного буфера равен размеру страницы памяти.
В зависимости от платформы это или 4K, или 8K,
однако его можно сделать меньше.
</p><a name="uwsgi_buffering"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_buffering</strong> <code>on</code> | <code>off</code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_buffering on;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Разрешает или запрещает использовать буферизацию ответов uwsgi-сервера.
</p><p>
Если буферизация включена, то nginx принимает ответ uwsgi-сервера
как можно быстрее, сохраняя его в буферы, заданные директивами
<a href="#uwsgi_buffer_size">uwsgi_buffer_size</a> и <a href="#uwsgi_buffers">uwsgi_buffers</a>.
Если ответ не вмещается целиком в память, то его часть может быть записана
на диск во <a href="#uwsgi_temp_path">временный файл</a>.
Запись во временные файлы контролируется директивами
<a href="#uwsgi_max_temp_file_size">uwsgi_max_temp_file_size</a> и
<a href="#uwsgi_temp_file_write_size">uwsgi_temp_file_write_size</a>.
</p><p>
Если буферизация выключена, то ответ синхронно передаётся клиенту сразу же
по мере его поступления.
nginx не пытается считать весь ответ uwsgi-сервера.
Максимальный размер данных, который nginx может принять от сервера
за один раз, задаётся директивой <a href="#uwsgi_buffer_size">uwsgi_buffer_size</a>.
</p><p>
Буферизация может быть также включена или выключена путём передачи
значения “<code>yes</code>” или “<code>no</code>” в поле
“X-Accel-Buffering” заголовка ответа.
Эту возможность можно запретить с помощью директивы
<a href="#uwsgi_ignore_headers">uwsgi_ignore_headers</a>.
</p><a name="uwsgi_buffers"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_buffers</strong> <code><i>число</i></code> <code><i>размер</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_buffers 8 4k|8k;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Задаёт <code><i>число</i></code> и <code><i>размер</i></code> буферов
для одного соединения,
в которые будет читаться ответ, получаемый от uwsgi-сервера.
По умолчанию размер одного буфера равен размеру страницы.
В зависимости от платформы это или 4K, или 8K.
</p><a name="uwsgi_busy_buffers_size"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_busy_buffers_size</strong> <code><i>размер</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_busy_buffers_size 8k|16k;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
При включённой <a href="#uwsgi_buffering">буферизации</a> ответов
uwsgi-сервера, ограничивает суммарный <code><i>размер</i></code>
буферов, которые могут быть заняты для отправки ответа клиенту, пока
ответ ещё не прочитан целиком.
Оставшиеся буферы тем временем могут использоваться для чтения ответа
и, при необходимости, буферизации части ответа во временный файл.
По умолчанию <code><i>размер</i></code> ограничен двумя буферами, заданными
директивами <a href="#uwsgi_buffer_size">uwsgi_buffer_size</a> и <a href="#uwsgi_buffers">uwsgi_buffers</a>.
</p><a name="uwsgi_cache"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_cache</strong> <code><i>зона</i></code> | <code>off</code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_cache off;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Задаёт зону разделяемой памяти, используемой для кэширования.
Одна и та же зона может использоваться в нескольких местах.
В значении параметра можно использовать переменные (1.7.9).
Параметр <code>off</code> запрещает кэширование, унаследованное
с предыдущего уровня конфигурации.
</p><a name="uwsgi_cache_background_update"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_cache_background_update</strong> <code>on</code> | <code>off</code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_cache_background_update off;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.11.10.
            </p></div><p>
Позволяет запустить фоновый подзапрос
для обновления просроченного элемента кэша,
в то время как клиенту возвращается устаревший закэшированный ответ.
Использование устаревшего закэшированного ответа в момент его обновления
должно быть
<a href="#uwsgi_cache_use_stale_updating">разрешено</a>.
</p><a name="uwsgi_cache_bypass"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_cache_bypass</strong> <code><i>строка</i></code> ...;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            
            —
        
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Задаёт условия, при которых ответ не будет браться из кэша.
Если значение хотя бы одного из строковых параметров непустое и не равно “0”,
то ответ не берётся из кэша:
</p> <blockquote class="example"><pre>
uwsgi_cache_bypass $cookie_nocache $arg_nocache$arg_comment;
uwsgi_cache_bypass $http_pragma    $http_authorization;
</pre></blockquote><p> 
Можно использовать совместно с директивой <a href="#uwsgi_no_cache">uwsgi_no_cache</a>.
</p><a name="uwsgi_cache_key"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_cache_key</strong> <code><i>строка</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            
            —
        
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Задаёт ключ для кэширования, например,
</p> <blockquote class="example"><pre>
uwsgi_cache_key localhost:9000$request_uri;
</pre></blockquote><p> 
</p><a name="uwsgi_cache_lock"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_cache_lock</strong> <code>on</code> | <code>off</code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_cache_lock off;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.1.12.
            </p></div><p>
Если включено, одновременно только одному запросу будет позволено
заполнить новый элемент кэша, идентифицируемый согласно директиве
<a href="#uwsgi_cache_key">uwsgi_cache_key</a>, передав запрос на uwsgi-сервер.
Остальные запросы этого же элемента будут либо ожидать
появления ответа в кэше, либо освобождения блокировки
этого элемента, в течение времени, заданного директивой
<a href="#uwsgi_cache_lock_timeout">uwsgi_cache_lock_timeout</a>.
</p><a name="uwsgi_cache_lock_age"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_cache_lock_age</strong> <code><i>время</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_cache_lock_age 5s;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.7.8.
            </p></div><p>
Если последний запрос, переданный на uwsgi-сервер
для заполнения нового элемента кэша,
не завершился за указанное <code><i>время</i></code>,
на uwsgi-сервер может быть передан ещё один запрос.
</p><a name="uwsgi_cache_lock_timeout"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_cache_lock_timeout</strong> <code><i>время</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_cache_lock_timeout 5s;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.1.12.
            </p></div><p>
Задаёт таймаут для <a href="#uwsgi_cache_lock">uwsgi_cache_lock</a>.
По истечении указанного <code><i>времени</i></code>
запрос будет передан на uwsgi-сервер,
однако ответ не будет закэширован.
</p> <blockquote class="note">
До версии 1.7.8 такой ответ мог быть закэширован.
</blockquote><p> 
</p><a name="uwsgi_cache_max_range_offset"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_cache_max_range_offset</strong> <code><i>число</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            
            —
        
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.11.6.
            </p></div><p>
Задаёт смещение в байтах для запросов с указанием диапазона запрашиваемых байт
(byte-range requests).
Если диапазон находится за указанным смещением,
range-запрос будет передан на uwsgi-сервер
и ответ не будет закэширован.
</p><a name="uwsgi_cache_methods"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_cache_methods</strong> 
    <code>GET</code> |
    <code>HEAD</code> |
    <code>POST</code>
    ...;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_cache_methods GET HEAD;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Если метод запроса клиента указан в этой директиве,
то ответ будет закэширован.
Методы “<code>GET</code>” и “<code>HEAD</code>” всегда добавляются
в список, но тем не менее рекомендуется перечислять их явно.
См. также директиву <a href="#uwsgi_no_cache">uwsgi_no_cache</a>.
</p><a name="uwsgi_cache_min_uses"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_cache_min_uses</strong> <code><i>число</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_cache_min_uses 1;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Задаёт <code><i>число</i></code> запросов, после которого ответ будет закэширован.
</p><a name="uwsgi_cache_path"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_cache_path</strong> 
    <code><i>путь</i></code>
    [<code>levels</code>=<code><i>уровни</i></code>]
    [<code>use_temp_path</code>=<code>on</code>|<code>off</code>]
    <code>keys_zone</code>=<code><i>имя</i></code>:<code><i>размер</i></code>
    [<code>inactive</code>=<code><i>время</i></code>]
    [<code>max_size</code>=<code><i>размер</i></code>]
    [<code>min_free</code>=<code><i>размер</i></code>]
    [<code>manager_files</code>=<code><i>число</i></code>]
    [<code>manager_sleep</code>=<code><i>время</i></code>]
    [<code>manager_threshold</code>=<code><i>время</i></code>]
    [<code>loader_files</code>=<code><i>число</i></code>]
    [<code>loader_sleep</code>=<code><i>время</i></code>]
    [<code>loader_threshold</code>=<code><i>время</i></code>]
    [<code>purger</code>=<code>on</code>|<code>off</code>]
    [<code>purger_files</code>=<code><i>число</i></code>]
    [<code>purger_sleep</code>=<code><i>время</i></code>]
    [<code>purger_threshold</code>=<code><i>время</i></code>];</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            
            —
        
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code><br>
                </td>
                </tr>
            </table></div><p>
Задаёт путь и другие параметры кэша.
Данные кэша хранятся в файлах.
Именем файла в кэше является результат функции MD5
от <a href="#uwsgi_cache_key">ключа кэширования</a>.
Параметр <code>levels</code> задаёт уровни иерархии кэша:
можно задать от 1 до 3 уровней, на каждом уровне допускаются значения 1 или 2.
Например, при использовании
</p> <blockquote class="example"><pre>
uwsgi_cache_path /data/nginx/cache levels=1:2 keys_zone=one:10m;
</pre></blockquote><p> 
имена файлов в кэше будут такого вида:
</p> <blockquote class="example"><pre>
/data/nginx/cache/<strong>c</strong>/<strong>29</strong>/b7f54b2df7773722d382f4809d650<strong>29c</strong>
</pre></blockquote><p> 
</p><p>
Кэшируемый ответ сначала записывается во временный файл, а потом этот файл
переименовывается.
Начиная с версии 0.8.9 временные файлы и кэш
могут располагаться на разных файловых системах.
Однако нужно учитывать,
что в этом случае вместо дешёвой операции переименовывания в пределах
одной файловой системы файл копируется с одной файловой системы на другую.
Поэтому лучше, если кэш будет находиться на той же файловой
системе, что и каталог с временными файлами.
Какой из каталогов будет использоваться для временных файлов
определяется параметром <code>use_temp_path</code> (1.7.10).
Если параметр не задан или установлен в значение “<code>on</code>”,
то будет использоваться каталог, задаваемый директивой
<a href="#uwsgi_temp_path">uwsgi_temp_path</a> для данного location.
Если параметр установлен в значение “<code>off</code>”,
то временные файлы будут располагаться непосредственно в каталоге кэша.
</p><p>
Кроме того, все активные ключи и информация о данных хранятся в зоне
разделяемой памяти, <code><i>имя</i></code> и <code><i>размер</i></code> которой
задаются параметром <code>keys_zone</code>.
Зоны размером в 1 мегабайт достаточно для хранения около 8 тысяч ключей.
</p> <blockquote class="note">
Как часть
<a href="http://nginx.com/products/">коммерческой подписки</a>
в зоне разделяемой памяти также хранится расширенная
<a href="ngx_http_api_module.html#http_caches_">информация</a> о кэше,
поэтому для хранения аналогичного количества ключей необходимо указывать
больший размер зоны.
Например
зоны размером в 1 мегабайт достаточно для хранения около 4 тысяч ключей.
</blockquote><p> 
</p><p>
Если к данным кэша не обращаются в течение времени, заданного параметром
<code>inactive</code>, то данные удаляются, независимо от их свежести.
По умолчанию <code>inactive</code> равен 10 минутам.
</p><a name="uwsgi_cache_path_max_size"></a><p>
Специальный процесс “cache manager” следит за максимальным размером кэша,
заданным параметром <code>max_size</code>,
а также за минимальным объёмом свободного места на файловой системе с кэшем,
заданным параметром <code>min_free</code> (1.19.1).
При превышении максимального размера кэша
или недостаточном объёме свободного места
процесс удаляет наименее востребованные данные.
Удаление данных происходит итерациями, настраиваемыми параметрами (1.11.5)
<code>manager_files</code>,
<code>manager_threshold</code> и
<code>manager_sleep</code>.
За одну итерацию загружается не более <code>manager_files</code>
элементов (по умолчанию 100).
Время работы одной итерации ограничено параметром
<code>manager_threshold</code> (по умолчанию 200 миллисекунд).
Между итерациями делается пауза на время, заданное параметром
<code>manager_sleep</code> (по умолчанию 50 миллисекунд).
</p><p>
Через минуту после старта активируется специальный процесс “cache loader”,
который загружает в зону кэша информацию о ранее закэшированных данных,
хранящихся на файловой системе.
Загрузка также происходит итерациями.
За одну итерацию загружается не более <code>loader_files</code>
элементов (по умолчанию 100).
Кроме того, время работы одной итерации ограничено параметром
<code>loader_threshold</code> (по умолчанию 200 миллисекунд).
Между итерациями делается пауза на время, заданное параметром
<code>loader_sleep</code> (по умолчанию 50 миллисекунд).
</p><p>
Кроме того,
следующие параметры доступны как часть
<a href="http://nginx.com/products/">коммерческой подписки</a>:
</p><p>
</p> <dl class="compact">

<dt id="purger">
<code>purger</code>=<code>on</code>|<code>off</code>
</dt>
<dd>
Указывает, будут ли записи в кэше, соответствующие
<a href="#uwsgi_cache_purge">маске</a>,
удалены с диска при помощи процесса “cache purger” (1.7.12).
Установка параметра в значение <code>on</code>
(по умолчанию <code>off</code>)
активирует процесс “cache purger”, который
проходит по всем записям в кэше
и удаляет записи, соответствующие этой маске.
</dd>

<dt id="purger_files">
<code>purger_files</code>=<code><i>число</i></code>
</dt>
<dd>
Задаёт число элементов, которые будут сканироваться за одну итерацию (1.7.12).
По умолчанию <code>purger_files</code> равен 10.
</dd>

<dt id="purger_threshold">
<code>purger_threshold</code>=<code><i>время</i></code>
</dt>
<dd>
Задаёт продолжительность одной итерации (1.7.12).
По умолчанию <code>purger_threshold</code> равен 50 миллисекундам.
</dd>

<dt id="purger_sleep">
<code>purger_sleep</code>=<code><i>время</i></code>
</dt>
<dd>
Задаёт паузу между итерациями (1.7.12).
По умолчанию <code>purger_sleep</code> равен 50 миллисекундам.
</dd>

</dl><p> 
</p><p>
</p> <blockquote class="note">
В версиях 1.7.3, 1.7.7 и 1.11.10 формат заголовка кэша был изменён.
При обновлении на более новую версию nginx
ранее закэшированные ответы будут считаться недействительными.
</blockquote><p> 
</p><a name="uwsgi_cache_purge"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_cache_purge</strong> строка ...;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            
            —
        
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.5.7.
            </p></div><p>
Задаёт условия, при которых запрос будет считаться запросом
на очистку кэша.
Если значение хотя бы одного из строковых параметров непустое и не равно “0”,
то запись в кэше с соответствующим
<a href="#uwsgi_cache_key">ключом кэширования</a> удаляется.
В результате успешной операции возвращается ответ с кодом
204 (No Content).
</p><p>
Если <a href="#uwsgi_cache_key">ключ кэширования</a>
запроса на очистку заканчивается
звёздочкой (“<code>*</code>”), то все записи в кэше, соответствующие
этой маске, будут удалены из кэша.
Тем не менее, эти записи будут оставаться на диске или до момента удаления
из-за <a href="#uwsgi_cache_path">отсутствия обращения к данным</a>,
или до обработки их процессом “<a href="#purger">cache purger</a>” (1.7.12),
или до попытки клиента получить к ним доступ.
</p><p>
Пример конфигурации:
</p> <blockquote class="example"><pre>
uwsgi_cache_path /data/nginx/cache keys_zone=cache_zone:10m;

map $request_method $purge_method {
    PURGE   1;
    default 0;
}

server {
    ...
    location / {
        uwsgi_pass        http://backend;
        uwsgi_cache       cache_zone;
        uwsgi_cache_key   $uri;
        uwsgi_cache_purge $purge_method;
    }
}
</pre></blockquote><p> 
</p> <blockquote class="note">
Функциональность доступна как часть
<a href="http://nginx.com/products/">коммерческой подписки</a>.
</blockquote><p> 
</p><a name="uwsgi_cache_revalidate"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_cache_revalidate</strong> <code>on</code> | <code>off</code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_cache_revalidate off;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.5.7.
            </p></div><p>
Разрешает ревалидацию просроченных элементов кэша при помощи
условных запросов с полями заголовка
“If-Modified-Since” и “If-None-Match”.
</p><a name="uwsgi_cache_use_stale"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_cache_use_stale</strong> 
    <code>error</code> |
    <code>timeout</code> |
    <code>invalid_header</code> |
    <code>updating</code> |
    <code>http_500</code> |
    <code>http_503</code> |
    <code>http_403</code> |
    <code>http_404</code> |
    <code>http_429</code> |
    <code>off</code>
    ...;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_cache_use_stale off;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Определяет, в каких случаях можно использовать устаревший закэшированный ответ.
Параметры директивы совпадают с параметрами
директивы <a href="#uwsgi_next_upstream">uwsgi_next_upstream</a>.
</p><p>
Параметр <code>error</code> также позволяет использовать
устаревший закэшированный ответ при невозможности выбора
uwsgi-сервера для обработки запроса.
</p><a name="uwsgi_cache_use_stale_updating"></a><p>
Кроме того, дополнительный параметр <code>updating</code>
разрешает использовать устаревший закэшированный ответ,
если на данный момент он уже обновляется.
Это позволяет минимизировать число обращений к uwsgi-серверам
при обновлении закэшированных данных.
</p><p>
Использование устаревшего закэшированного ответа
может также быть разрешено непосредственно в заголовке ответа
на определённое количество секунд после того, как ответ устарел (1.11.10).
Такой способ менее приоритетен, чем задание параметров директивы.
</p> <ul>

<li>
Расширение
“<a href="https://datatracker.ietf.org/doc/html/rfc5861#section-3">stale-while-revalidate</a>”
поля заголовка “Cache-Control” разрешает
использовать устаревший закэшированный ответ,
если на данный момент он уже обновляется.
</li>

<li>
Расширение
“<a href="https://datatracker.ietf.org/doc/html/rfc5861#section-4">stale-if-error</a>”
поля заголовка “Cache-Control” разрешает
использовать устаревший закэшированный ответ в случае ошибки.
</li>

</ul><p> 
</p><p>
Чтобы минимизировать число обращений к uwsgi-серверам при
заполнении нового элемента кэша, можно воспользоваться директивой
<a href="#uwsgi_cache_lock">uwsgi_cache_lock</a>.
</p><a name="uwsgi_cache_valid"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_cache_valid</strong> [<code><i>код</i></code> ...] <code><i>время</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            
            —
        
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Задаёт время кэширования для разных кодов ответа.
Например, директивы
</p> <blockquote class="example"><pre>
uwsgi_cache_valid 200 302 10m;
uwsgi_cache_valid 404      1m;
</pre></blockquote><p> 
задают время кэширования 10 минут для ответов с кодами 200 и 302
и 1 минуту для ответов с кодом 404.
</p><p>
Если указано только <code><i>время</i></code> кэширования,
</p> <blockquote class="example"><pre>
uwsgi_cache_valid 5m;
</pre></blockquote><p> 
то кэшируются только ответы 200, 301 и 302.
</p><p>
Кроме того, можно кэшировать любые ответы с помощью параметра
<code>any</code>:
</p> <blockquote class="example"><pre>
uwsgi_cache_valid 200 302 10m;
uwsgi_cache_valid 301      1h;
uwsgi_cache_valid any      1m;
</pre></blockquote><p> 
</p><p>
Параметры кэширования могут также быть заданы непосредственно
в заголовке ответа.
Такой способ приоритетнее, чем задание времени кэширования с помощью директивы.
</p> <ul>

<li>
Поле заголовка “X-Accel-Expires” задаёт время кэширования
ответа в секундах.
Значение 0 запрещает кэшировать ответ.
Если значение начинается с префикса <code>@</code>, оно задаёт абсолютное
время в секундах с начала эпохи, до которого ответ может быть закэширован.
</li>

<li>
Если в заголовке нет поля “X-Accel-Expires”,
параметры кэширования определяются по полям заголовка
“Expires” или “Cache-Control”.
</li>

<li>
Ответ, в заголовке которого есть поле “Set-Cookie”,
не будет кэшироваться.
</li>

<li>
Ответ, в заголовке которого есть поле “Vary”
со специальным значением “<code>*</code>”,
не будет кэшироваться (1.7.7).
Ответ, в заголовке которого есть поле “Vary”
с другим значением, будет закэширован
с учётом соответствующих полей заголовка запроса (1.7.7).
</li>

</ul><p> 
Обработка одного или более из этих полей заголовка может быть отключена
при помощи директивы <a href="#uwsgi_ignore_headers">uwsgi_ignore_headers</a>.
</p><a name="uwsgi_connect_timeout"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_connect_timeout</strong> <code><i>время</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_connect_timeout 60s;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Задаёт таймаут для установления соединения с uwsgi-сервером.
Необходимо иметь в виду, что этот таймаут обычно не может превышать 75 секунд.
</p><a name="uwsgi_force_ranges"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_force_ranges</strong> <code>on</code> | <code>off</code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_force_ranges off;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.7.7.
            </p></div><p>
Включает поддержку диапазонов запрашиваемых байт (byte-range)
для кэшированных и некэшированных ответов uwsgi-сервера
вне зависимости от наличия поля “Accept-Ranges”
в заголовках этих ответов.
</p><a name="uwsgi_hide_header"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_hide_header</strong> <code><i>поле</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            
            —
        
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
По умолчанию
nginx не передаёт клиенту поля заголовка “Status” и
“X-Accel-...” из ответа uwsgi-сервера.
Директива <code>uwsgi_hide_header</code> задаёт дополнительные поля,
которые не будут передаваться.
Если же передачу полей нужно разрешить, можно воспользоваться
директивой <a href="#uwsgi_pass_header">uwsgi_pass_header</a>.
</p><a name="uwsgi_ignore_client_abort"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_ignore_client_abort</strong> <code>on</code> | <code>off</code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_ignore_client_abort off;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Определяет, закрывать ли соединение с uwsgi-сервером
в случае, если клиент закрыл соединение, не дождавшись ответа.
</p><a name="uwsgi_ignore_headers"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_ignore_headers</strong> <code><i>поле</i></code> ...;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            
            —
        
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Запрещает обработку некоторых полей заголовка из ответа uwsgi-сервера.
В директиве можно указать поля “X-Accel-Redirect”,
“X-Accel-Expires”, “X-Accel-Limit-Rate” (1.1.6),
“X-Accel-Buffering” (1.1.6),
“X-Accel-Charset” (1.1.6), “Expires”,
“Cache-Control”, “Set-Cookie” (0.8.44)
и “Vary” (1.7.7).
</p><p>
Если не запрещено, обработка этих полей заголовка заключается в следующем:
</p> <ul>

<li>
“X-Accel-Expires”, “Expires”,
“Cache-Control”, “Set-Cookie”
и “Vary”
задают параметры <a href="#uwsgi_cache_valid">кэширования</a> ответа;
</li>

<li>
“X-Accel-Redirect” производит
<a href="ngx_http_core_module.html#internal">внутреннее
перенаправление</a> на указанный URI;
</li>

<li>
“X-Accel-Limit-Rate” задаёт
<a href="ngx_http_core_module.html#limit_rate">ограничение
скорости</a> передачи ответа клиенту;
</li>

<li>
“X-Accel-Buffering” включает или выключает
<a href="#uwsgi_buffering">буферизацию</a> ответа;
</li>

<li>
“X-Accel-Charset” задаёт желаемую
<a href="ngx_http_charset_module.html#charset">кодировку</a>
ответа.
</li>

</ul><p> 
</p><a name="uwsgi_intercept_errors"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_intercept_errors</strong> <code>on</code> | <code>off</code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_intercept_errors off;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Определяет, передавать ли клиенту ответы uwsgi-сервера с кодом
больше либо равным 300,
или же перехватывать их и перенаправлять на обработку nginx’у с помощью
директивы <a href="ngx_http_core_module.html#error_page">error_page</a>.
</p><a name="uwsgi_limit_rate"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_limit_rate</strong> <code><i>скорость</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_limit_rate 0;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.7.7.
            </p></div><p>
Ограничивает скорость чтения ответа от uwsgi-сервера.
<code><i>Скорость</i></code> задаётся в байтах в секунду.
Значение 0 отключает ограничение скорости.
Ограничение устанавливается на запрос,
поэтому, если nginx одновременно
откроет два соединения к uwsgi-серверу,
суммарная скорость будет вдвое выше заданного ограничения.
Ограничение работает только в случае, если включена
<a href="#uwsgi_buffering">буферизация</a> ответов uwsgi-сервера.
</p><a name="uwsgi_max_temp_file_size"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_max_temp_file_size</strong> <code><i>размер</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_max_temp_file_size 1024m;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Если включена <a href="#uwsgi_buffering">буферизация</a> ответов
uwsgi-сервера, и ответ не вмещается целиком в буферы,
заданные директивами <a href="#uwsgi_buffer_size">uwsgi_buffer_size</a> и
<a href="#uwsgi_buffers">uwsgi_buffers</a>, часть ответа может быть записана во временный файл.
Эта директива задаёт максимальный <code><i>размер</i></code> временного файла.
Размер данных, сбрасываемых во временный файл за один раз, задаётся
директивой <a href="#uwsgi_temp_file_write_size">uwsgi_temp_file_write_size</a>.
</p><p>
Значение 0 отключает возможность буферизации ответов во временные файлы.
</p><p>
</p> <blockquote class="note">
Данное ограничение не распространяется на ответы,
которые будут <a href="#uwsgi_cache">закэшированы</a>
или <a href="#uwsgi_store">сохранены</a> на диске.
</blockquote><p> 
</p><a name="uwsgi_modifier1"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_modifier1</strong> <code><i>число</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_modifier1 0;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Задаёт значение поля <code>modifier1</code> в
<a href="http://uwsgi-docs.readthedocs.org/en/latest/Protocol.html#uwsgi-packet-header">заголовке
пакета uwsgi</a>.
</p><a name="uwsgi_modifier2"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_modifier2</strong> <code><i>число</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_modifier2 0;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Задаёт значение поля <code>modifier2</code> в
<a href="http://uwsgi-docs.readthedocs.org/en/latest/Protocol.html#uwsgi-packet-header">заголовке
пакета uwsgi</a>.
</p><a name="uwsgi_next_upstream"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_next_upstream</strong> 
    <code>error</code> |
    <code>timeout</code> |
    <code>invalid_header</code> |
    <code>http_500</code> |
    <code>http_503</code> |
    <code>http_403</code> |
    <code>http_404</code> |
    <code>http_429</code> |
    <code>non_idempotent</code> |
    <code>off</code>
    ...;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_next_upstream error timeout;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Определяет, в каких случаях запрос будет передан следующему серверу:
</p> <dl class="compact">

<dt><code>error</code></dt>
<dd>произошла ошибка соединения с сервером, передачи ему запроса или
чтения заголовка ответа сервера;</dd>

<dt><code>timeout</code></dt>
<dd>произошёл таймаут во время соединения с сервером,
передачи ему запроса или чтения заголовка ответа сервера;</dd>

<dt><code>invalid_header</code></dt>
<dd>сервер вернул пустой или неверный ответ;</dd>

<dt><code>http_500</code></dt>
<dd>сервер вернул ответ с кодом 500;</dd>

<dt><code>http_503</code></dt>
<dd>сервер вернул ответ с кодом 503;</dd>

<dt><code>http_403</code></dt>
<dd>сервер вернул ответ с кодом 403;</dd>

<dt><code>http_404</code></dt>
<dd>сервер вернул ответ с кодом 404;</dd>

<dt><code>http_429</code></dt>
<dd>сервер вернул ответ с кодом 429 (1.11.13);</dd>

<dt id="non_idempotent"><code>non_idempotent</code></dt>
<dd>обычно запросы с
<a href="https://datatracker.ietf.org/doc/html/rfc7231#section-4.2.2">неидемпотентным</a>
методом
(<code>POST</code>, <code>LOCK</code>, <code>PATCH</code>)
не передаются на другой сервер,
если запрос серверу группы уже был отправлен (1.9.13);
включение параметра явно разрешает повторять подобные запросы;
</dd>

<dt><code>off</code></dt>
<dd>запрещает передачу запроса следующему серверу.</dd>

</dl><p> 
</p><p>
Необходимо понимать, что передача запроса следующему серверу возможна
только при условии, что клиенту ещё ничего не передавалось.
То есть, если ошибка или таймаут возникли в середине передачи ответа,
то исправить это уже невозможно.
</p><p>
Директива также определяет, что считается
<a href="ngx_http_upstream_module.html#max_fails">неудачной
попыткой</a> работы с сервером.
Случаи <code>error</code>, <code>timeout</code> и
<code>invalid_header</code>
всегда считаются неудачными попытками, даже если они не указаны в директиве.
Случаи <code>http_500</code>, <code>http_503</code>
и <code>http_429</code>
считаются неудачными попытками, только если они указаны в директиве.
Случаи <code>http_403</code> и <code>http_404</code>
никогда не считаются неудачными попытками.
</p><p>
Передача запроса следующему серверу может быть ограничена по
<a href="#uwsgi_next_upstream_tries">количеству попыток</a>
и по <a href="#uwsgi_next_upstream_timeout">времени</a>.
</p><a name="uwsgi_next_upstream_timeout"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_next_upstream_timeout</strong> <code><i>время</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_next_upstream_timeout 0;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.7.5.
            </p></div><p>
Ограничивает время, в течение которого возможна передача запроса
<a href="#uwsgi_next_upstream">следующему серверу</a>.
Значение <code>0</code> отключает это ограничение.
</p><a name="uwsgi_next_upstream_tries"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_next_upstream_tries</strong> <code><i>число</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_next_upstream_tries 0;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.7.5.
            </p></div><p>
Ограничивает число допустимых попыток для передачи запроса
<a href="#uwsgi_next_upstream">следующему серверу</a>.
Значение <code>0</code> отключает это ограничение.
</p><a name="uwsgi_no_cache"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_no_cache</strong> <code><i>строка</i></code> ...;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            
            —
        
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Задаёт условия, при которых ответ не будет сохраняться в кэш.
Если значение хотя бы одного из строковых параметров непустое и не равно “0”,
то ответ не будет сохранён:
</p> <blockquote class="example"><pre>
uwsgi_no_cache $cookie_nocache $arg_nocache$arg_comment;
uwsgi_no_cache $http_pragma    $http_authorization;
</pre></blockquote><p> 
Можно использовать совместно с директивой <a href="#uwsgi_cache_bypass">uwsgi_cache_bypass</a>.
</p><a name="uwsgi_param"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_param</strong> 
    <code><i>параметр</i></code> <code><i>значение</i></code>
    [<code>if_not_empty</code>];</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            
            —
        
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Задаёт <code><i>параметр</i></code>, который будет передаваться uwsgi-серверу.
В качестве значения можно использовать текст, переменные и их комбинации.
Директивы наследуются с предыдущего уровня конфигурации при условии, что
на данном уровне не описаны свои директивы <code>uwsgi_param</code>.
</p><p>
Стандартные
<a href="https://datatracker.ietf.org/doc/html/rfc3875#section-4.1">переменные
окружения CGI</a>
должны передаваться как заголовки uwsgi, см. файл <code>uwsgi_params</code>
из дистрибутива:
</p> <blockquote class="example"><pre>
location / {
    include uwsgi_params;
    ...
}
</pre></blockquote><p> 
</p><p>
Если директива указана с <code>if_not_empty</code> (1.1.11),
то такой параметр с пустым значением передаваться на сервер не будет:
</p> <blockquote class="example"><pre>
uwsgi_param HTTPS $https if_not_empty;
</pre></blockquote><p> 
</p><a name="uwsgi_pass"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_pass</strong> [<code><i>протокол</i></code>://]<code><i>адрес</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            
            —
        
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>location</code>, <code>if в location</code><br>
                </td>
                </tr>
            </table></div><p>
Задаёт протокол и адрес uwsgi-сервера.
В качестве протокола можно указать
“<code>uwsgi</code>” или “<code>suwsgi</code>”
(secured uwsgi, uwsgi через SSL).
Адрес может быть указан в виде доменного имени или IP-адреса,
и порта:
</p> <blockquote class="example"><pre>
uwsgi_pass localhost:9000;
uwsgi_pass uwsgi://localhost:9000;
uwsgi_pass suwsgi://[2001:db8::1]:9090;
</pre></blockquote><p> 
или в виде пути UNIX-сокета:
</p> <blockquote class="example"><pre>
uwsgi_pass unix:/tmp/uwsgi.socket;
</pre></blockquote><p> 
</p><p>
Если доменному имени соответствует несколько адресов, то все они будут
использоваться по очереди (round-robin).
И, кроме того, адрес может быть
<a href="ngx_http_upstream_module.html">группой серверов</a>.
</p><p>
В значении параметра можно использовать переменные.
В этом случае, если адрес указан в виде доменного имени,
имя ищется среди описанных
<a href="ngx_http_upstream_module.html">групп серверов</a>
и если не найдено, то определяется с помощью
<a href="ngx_http_core_module.html#resolver">resolver</a>’а.
</p><p>
</p> <blockquote class="note">
Протокол secured uwsgi поддерживается начиная с версии 1.5.8.
</blockquote><p> 
</p><a name="uwsgi_pass_header"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_pass_header</strong> <code><i>поле</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            
            —
        
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Разрешает передавать от uwsgi-сервера клиенту
<a href="#uwsgi_hide_header">запрещённые для передачи</a> поля заголовка.
</p><a name="uwsgi_pass_request_body"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_pass_request_body</strong> <code>on</code> | <code>off</code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_pass_request_body on;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Позволяет запретить передачу исходного тела запроса
на uwsgi-сервер.
См. также директиву <a href="#uwsgi_pass_request_headers">uwsgi_pass_request_headers</a>.
</p><a name="uwsgi_pass_request_headers"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_pass_request_headers</strong> <code>on</code> | <code>off</code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_pass_request_headers on;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Позволяет запретить передачу полей заголовка исходного запроса на
uwsgi-сервер.
См. также директивы <a href="#uwsgi_pass_request_body">uwsgi_pass_request_body</a>.
</p><a name="uwsgi_read_timeout"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_read_timeout</strong> <code><i>время</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_read_timeout 60s;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Задаёт таймаут при чтении ответа uwsgi-сервера.
Таймаут устанавливается не на всю передачу ответа,
а только между двумя операциями чтения.
Если по истечении этого времени uwsgi-сервер ничего не передаст,
соединение закрывается.
</p><a name="uwsgi_request_buffering"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_request_buffering</strong> <code>on</code> | <code>off</code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_request_buffering on;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.7.11.
            </p></div><p>
Разрешает или запрещает использовать буферизацию тела запроса клиента.
</p><p>
Если буферизация включена, то тело запроса полностью
<a href="ngx_http_core_module.html#client_body_buffer_size">читается</a>
от клиента перед отправкой запроса на uwsgi-сервер.
</p><p>
Если буферизация выключена, то тело запроса отправляется
на uwsgi-сервер сразу же по мере его поступления.
В этом случае запрос не может быть передан
<a href="#uwsgi_next_upstream">следующему серверу</a>,
если nginx уже начал отправку тела запроса.
</p><p>
Если для отправки тела исходного запроса используется HTTP/1.1
и передача данных частями (chunked transfer encoding),
то тело запроса буферизуется независимо от значения директивы.
</p><a name="uwsgi_send_timeout"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_send_timeout</strong> <code><i>время</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_send_timeout 60s;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Задаёт таймаут при передаче запроса uwsgi-серверу.
Таймаут устанавливается не на всю передачу запроса,
а только между двумя операциями записи.
Если по истечении этого времени uwsgi-сервер не примет новых данных,
соединение закрывается.
</p><a name="uwsgi_socket_keepalive"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_socket_keepalive</strong> <code>on</code> | <code>off</code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_socket_keepalive off;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.15.6.
            </p></div><p>
Конфигурирует поведение “TCP keepalive”
для исходящих соединений к uwsgi-серверу.
По умолчанию для сокета действуют настройки операционной системы.
Если указано значение “<code>on</code>”, то
для сокета включается параметр <code>SO_KEEPALIVE</code>.
</p><a name="uwsgi_ssl_certificate"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_ssl_certificate</strong> <code><i>файл</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            
            —
        
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.7.8.
            </p></div><p>
Задаёт <code><i>файл</i></code> с сертификатом в формате PEM
для аутентификации на suwsgi-сервере.
</p><p>
Начиная с версии 1.21.0 в имени файла можно использовать переменные.
</p><a name="uwsgi_ssl_certificate_key"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_ssl_certificate_key</strong> <code><i>файл</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            
            —
        
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.7.8.
            </p></div><p>
Задаёт <code><i>файл</i></code> с секретным ключом в формате PEM
для аутентификации на suwsgi-сервере.
</p><p>
Вместо <code><i>файла</i></code> можно указать значение
<code>engine</code>:<code><i>имя</i></code>:<code><i>id</i></code> (1.7.9),
которое загружает ключ с указанным <code><i>id</i></code>
из OpenSSL engine с заданным <code><i>именем</i></code>.
</p><p>
Начиная с версии 1.21.0 в имени файла можно использовать переменные.
</p><a name="uwsgi_ssl_ciphers"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_ssl_ciphers</strong> <code><i>ciphers</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_ssl_ciphers DEFAULT;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.5.8.
            </p></div><p>
Описывает разрешённые шифры для запросов к suwsgi-серверу.
Шифры задаются в формате, поддерживаемом библиотекой OpenSSL.
</p><p>
Полный список можно посмотреть с помощью команды
“<code>openssl ciphers</code>”.
</p><a name="uwsgi_ssl_conf_command"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_ssl_conf_command</strong> <code><i>имя</i></code> <code><i>значение</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            
            —
        
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.19.4.
            </p></div><p>
Задаёт произвольные конфигурационные
<a href="https://www.openssl.org/docs/man1.1.1/man3/SSL_CONF_cmd.html">команды</a>
OpenSSL
при установлении соединения с suwsgi-сервером.
</p> <blockquote class="note">
Директива поддерживается при использовании OpenSSL 1.0.2 и выше.
</blockquote><p> 
</p><p>
На одном уровне может быть указано
несколько директив <code>uwsgi_ssl_conf_command</code>.
Директивы наследуются с предыдущего уровня конфигурации при условии, что
на данном уровне не описаны
свои директивы <code>uwsgi_ssl_conf_command</code>.
</p><p>
</p> <blockquote class="note">
Следует учитывать, что изменение настроек OpenSSL напрямую
может привести к неожиданному поведению.
</blockquote><p> 
</p><a name="uwsgi_ssl_crl"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_ssl_crl</strong> <code><i>файл</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            
            —
        
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.7.0.
            </p></div><p>
Указывает <code><i>файл</i></code> с отозванными сертификатами (CRL)
в формате PEM, используемыми при <a href="#uwsgi_ssl_verify">проверке</a>
сертификата suwsgi-сервера.
</p><a name="uwsgi_ssl_name"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_ssl_name</strong> <code><i>имя</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_ssl_name имя хоста из uwsgi_pass;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.7.0.
            </p></div><p>
Позволяет переопределить имя сервера, используемое при
<a href="#uwsgi_ssl_verify">проверке</a>
сертификата suwsgi-сервера, а также для
<a href="#uwsgi_ssl_server_name">передачи его через SNI</a>
при установлении соединения с suwsgi-сервером.
</p><p>
По умолчанию используется имя хоста из <a href="#uwsgi_pass">uwsgi_pass</a>.
</p><a name="uwsgi_ssl_password_file"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_ssl_password_file</strong> <code><i>файл</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            
            —
        
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.7.8.
            </p></div><p>
Задаёт <code><i>файл</i></code> с паролями от
<a href="#uwsgi_ssl_certificate_key">секретных ключей</a>,
где каждый пароль указан на отдельной строке.
Пароли применяются по очереди в момент загрузки ключа.
</p><a name="uwsgi_ssl_protocols"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_ssl_protocols</strong> 
    [<code>SSLv2</code>]
    [<code>SSLv3</code>]
    [<code>TLSv1</code>]
    [<code>TLSv1.1</code>]
    [<code>TLSv1.2</code>]
    [<code>TLSv1.3</code>];</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.5.8.
            </p></div><p>
Разрешает указанные протоколы для запросов к suwsgi-серверу.
</p><p>
</p> <blockquote class="note">
Параметр <code>TLSv1.3</code> используется по умолчанию
начиная с 1.23.4.
</blockquote><p> 
</p><a name="uwsgi_ssl_server_name"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_ssl_server_name</strong> <code>on</code> | <code>off</code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_ssl_server_name off;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.7.0.
            </p></div><p>
Разрешает или запрещает передачу имени сервера через
<a href="http://en.wikipedia.org/wiki/Server_Name_Indication">расширение
Server Name Indication протокола TLS</a> (SNI, RFC 6066)
при установлении соединения с suwsgi-сервером.
</p><a name="uwsgi_ssl_session_reuse"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_ssl_session_reuse</strong> <code>on</code> | <code>off</code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_ssl_session_reuse on;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.5.8.
            </p></div><p>
Определяет, использовать ли повторно SSL-сессии при
работе с suwsgi-сервером.
Если в логах появляются ошибки
“<code>SSL3_GET_FINISHED:digest check failed</code>”,
то можно попробовать выключить
повторное использование сессий.
</p><a name="uwsgi_ssl_trusted_certificate"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_ssl_trusted_certificate</strong> <code><i>файл</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            
            —
        
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.7.0.
            </p></div><p>
Задаёт <code><i>файл</i></code> с доверенными сертификатами CA в формате PEM,
используемыми при <a href="#uwsgi_ssl_verify">проверке</a>
сертификата suwsgi-сервера.
</p><a name="uwsgi_ssl_verify"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_ssl_verify</strong> <code>on</code> | <code>off</code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_ssl_verify off;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.7.0.
            </p></div><p>
Разрешает или запрещает проверку сертификата suwsgi-сервера.
</p><a name="uwsgi_ssl_verify_depth"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_ssl_verify_depth</strong> <code><i>число</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_ssl_verify_depth 1;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table><p>Эта директива появилась в версии 1.7.0.
            </p></div><p>
Устанавливает глубину проверки в цепочке сертификатов suwsgi-сервера.
</p><a name="uwsgi_store"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_store</strong> 
    <code>on</code> |
    <code>off</code> |
    <code><i>строка</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_store off;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Разрешает сохранение на диск файлов.
Параметр <code>on</code> сохраняет файлы в соответствии с путями,
указанными в директивах
<a href="ngx_http_core_module.html#alias">alias</a> или
<a href="ngx_http_core_module.html#root">root</a>.
Параметр <code>off</code> запрещает сохранение файлов.
Кроме того, имя файла можно задать явно с помощью строки с переменными:
</p> <blockquote class="example"><pre>
uwsgi_store /data/www$original_uri;
</pre></blockquote><p> 
</p><p>
Время изменения файлов выставляется согласно полученному полю
“Last-Modified” в заголовке ответа.
Ответ сначала записывается во временный файл, а потом этот файл
переименовывается.
Начиная с версии 0.8.9 временный файл и постоянное место хранения ответа
могут располагаться на разных файловых системах.
Однако нужно учитывать,
что в этом случае вместо дешёвой операции переименовывания в пределах
одной файловой системы файл копируется с одной файловой системы на другую.
Поэтому лучше, если сохраняемые файлы будут находиться на той же файловой
системе, что и каталог с временными файлами, задаваемый директивой
<a href="#uwsgi_temp_path">uwsgi_temp_path</a> для данного location.
</p><p>
Директиву можно использовать для создания локальных копий статических
неизменяемых файлов, например, так:
</p> <blockquote class="example"><pre>
location /images/ {
    root               /data/www;
    error_page         404 = /fetch$uri;
}

location /fetch/ {
    internal;

    uwsgi_pass         backend:9000;
    ...

    uwsgi_store        on;
    uwsgi_store_access user:rw group:rw all:r;
    uwsgi_temp_path    /data/temp;

    alias              /data/www/;
}
</pre></blockquote><p> 
</p><a name="uwsgi_store_access"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_store_access</strong> <code><i>пользователи</i></code>:<code><i>права</i></code> ...;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_store_access user:rw;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Задаёт права доступа для создаваемых файлов и каталогов, например,
</p> <blockquote class="example"><pre>
uwsgi_store_access user:rw group:rw all:r;
</pre></blockquote><p> 
</p><p>
Если заданы какие-либо права для <code>group</code> или
<code>all</code>, то права для <code>user</code>
указывать необязательно:
</p> <blockquote class="example"><pre>
uwsgi_store_access group:rw all:r;
</pre></blockquote><p> 
</p><a name="uwsgi_temp_file_write_size"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_temp_file_write_size</strong> <code><i>размер</i></code>;</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_temp_file_write_size 8k|16k;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Ограничивает <code><i>размер</i></code> данных, сбрасываемых во временный файл
за один раз, при включённой буферизации ответов uwsgi-сервера
во временные файлы.
По умолчанию <code><i>размер</i></code> ограничен двумя буферами, заданными
директивами <a href="#uwsgi_buffer_size">uwsgi_buffer_size</a> и <a href="#uwsgi_buffers">uwsgi_buffers</a>.
Максимальный размер временного файла задаётся директивой
<a href="#uwsgi_max_temp_file_size">uwsgi_max_temp_file_size</a>.
</p><a name="uwsgi_temp_path"></a><div class="directive"><table cellspacing="0">
                <tr>
                <th>
            Синтаксис:
                </th>
                <td>
            <code><strong>uwsgi_temp_path</strong> 
    <code><i>путь</i></code>
    [<code><i>уровень1</i></code>
    [<code><i>уровень2</i></code>
    [<code><i>уровень3</i></code>]]];</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Умолчание:
                </th>
                <td>
            <pre>uwsgi_temp_path uwsgi_temp;</pre>
                </td>
                </tr>
            
                <tr>
                <th>
            Контекст:
                </th>
                <td>
            <code>http</code>, <code>server</code>, <code>location</code><br>
                </td>
                </tr>
            </table></div><p>
Задаёт имя каталога для хранения временных файлов с данными,
полученными от uwsgi-серверов.
В каталоге может использоваться иерархия подкаталогов до трёх уровней.
Например, при такой конфигурации
</p> <blockquote class="example"><pre>
uwsgi_temp_path /spool/nginx/uwsgi_temp 1 2;
</pre></blockquote><p> 
временный файл будет следующего вида:
</p> <blockquote class="example"><pre>
/spool/nginx/uwsgi_temp/<strong>7</strong>/<strong>45</strong>/00000123<strong>457</strong>
</pre></blockquote><p> 
</p><p>
См. также параметр <code>use_temp_path</code> директивы
<a href="#uwsgi_cache_path">uwsgi_cache_path</a>.
</p>

</div></div></body></html>
